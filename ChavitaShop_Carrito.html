<!DOCTYPE html>
<html>
<head>
    <title>Carrito de Compras</title>
    <style>
        #carrito-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 300px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            padding: 15px;
            z-index: 1000;
        }
        .item-carrito {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #eee;
        }
        .btn-eliminar {
            background: #ff4757;
            color: white;
            border: none;
            padding: 3px 8px;
            border-radius: 3px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="carrito-container">
        <h2>ðŸ›’ Carrito (<span id="contador">0</span>)</h2>
        <div id="lista-carrito"></div>
        <p>Total: $<span id="total">0.00</span></p>
    </div>

    <script>
        // Cargar carrito desde localStorage
        let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
        let total = parseFloat(localStorage.getItem('total')) || 0;

        // Actualizar interfaz del carrito
        function actualizarCarrito() {
            document.getElementById('contador').textContent = 
                carrito.reduce((sum, item) => sum + item.cantidad, 0);
            
            document.getElementById('total').textContent = 
                total.toFixed(2);
            
            const lista = document.getElementById('lista-carrito');
            lista.innerHTML = carrito.map(item => `
                <div class="item-carrito">
                    <span>${item.nombre} (${item.cantidad})</span>
                    <span>$${(item.precio * item.cantidad).toFixed(2)}</span>
                </div>
            `).join('');
        }

        // Escuchar mensajes de los botones
        window.addEventListener('message', (event) => {
            if (event.data.action === 'agregarAlCarrito') {
                const { nombre, precio } = event.data;
                const itemExistente = carrito.find(item => item.nombre === nombre);
                
                if (itemExistente) {
                    itemExistente.cantidad++;
                } else {
                    carrito.push({ nombre, precio, cantidad: 1 });
                }
                
                total += precio;
                localStorage.setItem('carrito', JSON.stringify(carrito));
                localStorage.setItem('total', total.toString());
                actualizarCarrito();
            }
        });

        // Inicializar
        actualizarCarrito();
    </script>
</body>
</html>
